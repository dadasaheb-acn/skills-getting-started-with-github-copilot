# GitHub Copilot Instructions

## Project Overview

**Mergington High School Activities API** - A FastAPI-based web application for managing student enrollment in extracurricular activities. The system consists of a Python backend API and a JavaScript frontend UI.

## Architecture

### Backend Architecture (`src/app.py`)
- **Framework**: FastAPI with uvicorn server
- **Data Storage**: In-memory dictionary (ephemeral - resets on server restart)
- **Static Files**: Served via FastAPI's StaticFiles mount at `/static`
- **Root Route**: Redirects `/` to `/static/index.html`

### Key Data Structures
- **Activities**: Dictionary keyed by activity name (string identifier)
  - Each activity contains: `description`, `schedule`, `max_participants`, `participants` (list of emails)
- **No explicit Student model**: Students represented only by email addresses in activity participant lists

### Frontend Architecture (`src/static/`)
- **HTML** (`index.html`): Form-based UI for activity browsing and signup
- **JavaScript** (`app.js`): Async fetch-based API client that:
  - Loads activities on page load (`DOMContentLoaded`)
  - Displays activity cards with available spots calculation
  - Handles form submission with POST to signup endpoint
  - Shows success/error messages that auto-hide after 5 seconds
- **CSS** (`styles.css`): Styling for activity cards and form elements

### API Contract
| Method | Endpoint | Query/Path | Behavior |
|--------|----------|-----------|----------|
| GET | `/` | — | Redirects to `/static/index.html` |
| GET | `/activities` | — | Returns full activities dict |
| POST | `/activities/{activity_name}/signup` | `?email=student@example.com` | Appends email to participants list |

**Note**: No validation on duplicate signups or capacity checks in current implementation.

## Development Workflow

### Running the Application
```bash
# Install dependencies (from project root)
pip install -r requirements.txt

# Start the server (runs on http://localhost:8000)
python src/app.py
```

### API Documentation
- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc
(Both auto-generated by FastAPI)

### Testing
- Configured with pytest (see `pytest.ini`)
- Run tests from project root: `pytest`
- Pythonpath configured to include project root for imports

## Code Patterns & Conventions

### Activity Identifier Strategy
- Activities are identified by **exact string names** (e.g., "Chess Club", "Programming Class")
- Frontend uses `encodeURIComponent()` when passing activity names in URLs to handle special characters
- Never assume activity names are URL-safe without encoding

### Error Handling
- HTTP errors: Use FastAPI's `HTTPException` with appropriate status codes (404 for missing activity)
- Frontend errors: Caught in try-catch, displayed in message div with "error" class
- Success messages: Displayed with "success" class, auto-clear after 5 seconds

### Frontend Patterns
- All data fetching uses async/await with native `fetch()` API
- Form submission prevents default and uses `event.preventDefault()`
- DOM elements cached at top of event listener setup (e.g., `activitiesList`, `activitySelect`)
- Message display uses CSS class toggling (`hidden`, `success`, `error`)

## Important Implementation Notes

1. **No Persistence**: All data is in-memory. Changes are lost on server restart. This is intentional for a learning project.

2. **No Capacity Enforcement**: The `/signup` endpoint does NOT check if activity is at max capacity - any number of participants can be added beyond `max_participants`. This is a known gap.

3. **Activity Endpoint Returns Everything**: The `/activities` GET endpoint returns the complete internal dictionary including participant lists. No filtering or pagination.

4. **Stateless Server**: No session management. Each request is independent.

## Integration Points

- **Frontend to Backend**: Only via HTTP fetch to `/activities` and `/activities/{name}/signup`
- **Static Files**: Served from `src/static/` directory via FastAPI's StaticFiles mount
- **No Database**: No external database or persistence layer

## When Adding Features, Consider

- Maintain the simple in-memory data model unless explicitly required to change
- Use FastAPI's built-in OpenAPI/Swagger documentation (automatic)
- Keep frontend fetches async and handle errors with user-visible messages
- Activity names remain the primary identifier (not IDs)
- Test using pytest from project root with configured pythonpath
